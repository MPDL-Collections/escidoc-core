<?xml version="1.0" encoding="UTF-8"?><SDODE LA="D"><DP N="1"/><P ID="0001" ALIGN="LEFT"> xmlfulltext 简体中文网页 Die Erfindung bezieht sich auf ein Verfahren zum Erweitern einer mittels eines <BR/>Installationsprogrammes zu installierenden Anwendung um eine Funktion sowie auf ein <BR/>Computerprogrammprodukt. </P><P ID="0002" ALIGN="LEFT">Mit zunehmender Verbreitung von Computer-Netzwerken (wie z. B. das Internet) wird auch der <BR/>elektronische Vertrieb von Software über solche Netzwerke immer interessanter, wobei dieser <BR/>Vertrieb häufig von Software-Distributoren durchgeführt wird, die die zu vertreibende Software <BR/>von Software-Herstellern beziehen. Aufgrund der Komplexität heutiger Programme liegt diese <BR/>Software in der Regel als Softwarepaket vor, das ein Installationsprogramm und ein <BR/>Programmarchiv, in dem die mittels des Installationsprogrammes zu installierenden <BR/>Komponenten der gewünschten Anwendung abgelegt sind, umfaßt. Dies wird deshalb <BR/>gemacht, da die zu installierenden Komponenten häufig in unterschiedlichen Verzeichnissen <BR/>auf dem Zielsystem abgelegt oder sogar beim Betriebssystem des Zielsystems registriert <BR/>werden müssen. Des weiteren ermöglicht das Installationsprogramm häufig auch die De-Installation <BR/>der Anwendung. </P><P ID="0003" ALIGN="LEFT">Die zu installierenden Komponenten, die in der Installationsprogramm-Datei und/oder in <BR/>zusätzlichen Dateien abgelegt sind, sind in der Regel komprimiert und häufig zumindest <BR/>teilweise verschlüsselt, wobei das Dateiformat dieser Komponenten oft proprietär ist und nur <BR/>vom Installationsprogramm selbst verstanden wird. Soll nun eine solche installationsbereite <BR/>Anwendung nachträglich für den Vertrieb über ein Netzwerk erweitert werden, so ist es wichtig, <BR/>daß die installationsbereite Anwendung mit einer zusätzlichen Funktion, wie z.B. eine <BR/>Schutzfunktion gegen die unberechtigte Nutzung, versehen werden kann. Da jedoch der <BR/>Software-Distributor in der Regel nicht das Dateiformat der im Programmarchiv abgelegten, zu <BR/>installierenden Komponenten kennt, kann er somit die zu installierenden einzelnen <BR/>Komponenten nicht einfach verändern oder austauschen. <DP N="2"/></P><P ID="0004" ALIGN="LEFT">Eine Möglichkeit besteht nun darin, daß der Software-Distributor die installationsbereite <BR/>Anwendung installiert und eine der installierten Komponenten mit der von ihm gewünschten <BR/>Schutzfunktion versieht. Da der Software-Distributor in der Regel jedoch nicht alle nötigen <BR/>Informationen zur Erstellung der installationsbereiten Software besitzt und somit das <BR/>Programmarchiv, das die geschützte Komponente umfaßt, selbst nicht erzeugen kann, gibt er <BR/>die geschützte Komponente dem Software-Hersteller, der dann aus der geschützten <BR/>Komponente und den restlichen Komponenten wiederum eine installationsbereite Anwendung <BR/>erstellt, die nun die geschützte Komponente umfaßt. Dieses Vorgehen ist jedoch sehr <BR/>zeitaufwendig und führt nachteilig noch zu höheren Kosten. </P><P ID="0005" ALIGN="LEFT">Aus WO 99/52031 A1 ist ein Verfahren bekannt, um eine installationsbereite Anwendung, die <BR/>elektronisch vertrieben werden soll, mit einer sogenannten Ausprobieren/Kaufen-Fähigkeit <BR/>(Try/Buy-Fähigkeit) zu versehen, die einem Kunden die Möglichkeit gibt, die installationsbereite <BR/>Anwendung auf seinem Rechner zu installieren und für eine vorbestimmte Zeitdauer <BR/>auszuprobieren. Nach Ablauf dieser Zeitdauer kann die Anwendung nur noch dann weiter <BR/>verwendet werden, wenn sie nach Entrichten des Kaufpreises freigeschaltet wird. </P><P ID="0006" ALIGN="LEFT">Um nun eine installationsbereite Anwendung mit der Ausprobieren/Kaufen-Fähigkeit zu <BR/>versehen, wird zunächst ermittelt, nach welchen Regeln die installationsbereite Anwendung <BR/>aus den ursprünglichen Komponenten generiert wurde. Ausgehend davon wird dann das <BR/>Programmarchiv entpackt und eine gewünschte Komponente wird mit der <BR/>Ausprobieren/Kaufen-Eigenschaft versehen. Dann wird ein neues Programmarchiv erstellt, das <BR/>anstatt der ausgewählten Komponente die geänderte Komponente mit der <BR/>Ausprobieren/Kaufen-Eigenschaft enthält, wobei dieses neue Archiv gemäß den zuvor <BR/>festgestellten Regeln neu gepackt wird, so daß die Installation mittels der <BR/>Installationsprogramms gewährleistet werden kann. Somit wird die gewünschte Komponente <BR/>aus dem ursprünglichen Programmarchiv entfernt und durch die veränderte Komponente <BR/>ersetzt. Ferner muß bei diesem Verfahren die Art und Weise der Erzeugung des <BR/>Programmarchivs bekannt sein oder ermittelt werden können, um das modifizierte <BR/>Programmarchiv erzeugen zu können. </P><P ID="0007" ALIGN="LEFT">Ausgehend hiervon ist es Aufgabe der vorliegenden Erfindung, ein Verfahren zum Erweitern <BR/>einer mittels eines Installationsprogrammes zu installierenden Anwendung um eine Funktion <BR/>bereitzustellen, das ohne Kenntnis der Regeln zum Erzeugen des Programmarchivs <BR/>durchführbar ist. Des weiteren soll noch ein Computerprogrammprodukt bereitgestellt werden, <BR/>mit dem die Schritte des erfindungsgemäßen Verfahrens verwirklicht werden können. <DP N="3"/></P><P ID="0008" ALIGN="LEFT">Die Aufgabe wird durch das erfindungsgemäße Verfahren zum Erweitern einer mittels eines <BR/>Installationsprogrammes zu installierenden Anwendung um eine Funktion, wobei die zu <BR/>installierende Anwendung eine mittels des Installationsprogrammes zu installierende <BR/>Komponente aufweist, die in einem Programmarchiv abgelegt ist, und das <BR/>Installationsprogramm mit dem Programmarchiv ein Softwarepaket bildet, dadurch gelöst, daß <BR/>das Verfahren folgende Schritte umfaßt:<BR/>Hinzufügen einer um die Funktion erweiterten Version der zu installierenden Komponente und <BR/>von Hilfscode zum Softwarepaket, wobei dabei die Komponente weder zum Teil noch <BR/>vollständig aus dem Programmarchiv entfernt wird, und Ändern des Installationsprogrammes <BR/>derart, daß aufgrund seiner Ausführung der Hilfscode gestartet wird, der bewirkt, daß statt der <BR/>Komponente die erweiterte bzw. die geänderte Komponente installiert wird. </P><P ID="0009" ALIGN="LEFT">Bei diesem Verfahren ist es somit nicht notwendig, das Programmarchiv in der Weise zu <BR/>ändern, daß die Komponente (die ausführbaren Softwarecode und/oder Daten enthalten kann) <BR/>aus dem Programmarchiv entfernt ist, so daß ein Erweitern der installationsbereiten <BR/>Anwendung um die Funktion leicht möglich ist. Da weiter die geänderte Komponente und der <BR/>Hilfscode außerhalb des Programmarchivs zum Softwarepaket hinzugefügt werden, ist <BR/>insbesondere auch kein Neupacken des Programmarchivs erforderlich. Mit dem <BR/>erfindungsgemäßen Verfahren kann daher in vorteilhafter Weise ein Softwarepaket, das eine <BR/>mittels eines Installationsprogrammes zu installierende Anwendung enthält, nachträglich mit <BR/>einer Funktion versehen werden, ohne daß die Dateistruktur des Programmarchivs bekannt <BR/>sein muß. Dadurch kann ein schnell und einfach durchzuführendes Verfahren bereitgestellt <BR/>werden, mit dem gezielt eine Komponente eines Programmarchivs aus einem Softwarepaket <BR/>verändert werden kann. </P><P ID="0010" ALIGN="LEFT">In vorteilhafter Weise können mit dem erfindungsgemäßen Verfahren auch mehrere <BR/>zusätzliche Funktionen zur zu installierenden Anwendung hinzugefügt werden, so daß eine <BR/>umfassende nachträgliche Änderung der zu installierenden Anwendung möglich ist, ohne den <BR/>Quellcode der Anwendung kennen und die Komponente aus dem Programmarchiv entfernen <BR/>zu müssen. </P><P ID="0011" ALIGN="LEFT">Insbesondere kann man mit dem erfindungsgemäßen Verfahren auch mehrere Anwendungen, <BR/>die in einem Softwarepaket enthalten sind, jeweils um eine Funktion erweitern. Dabei kann <BR/>man denselben Hilfscode für alle zu schützenden Anwendungen einsetzen, wobei natürlich für <BR/>jede zu schützende Anwendung eine geschützte Komponente hinzugefügt wird. </P><P ID="0012" ALIGN="LEFT">Des weiteren kann man mit dem erfindungsgemäßen Verfahren, wenn die zu installierende <BR/>Anwendung mehrere zu installierende Komponenten umfaßt, die im Programmarchiv abgelegt <DP N="4"/> <BR/>sind, auch mehrere veränderte Komponenten der zu installierenden Anwendung erzeugen und <BR/>zum Softwarepaket hinzufügen, so daß sich die Funktion z. B. verbessern und verfeinern läßt <BR/>oder so daß die zu installierende Anwendung mehrere zusätzliche Funktionen aufweisen kann. <BR/>Mit dem erfindungsgemäßen Verfahren ist somit das nachträgliche Erweitern der <BR/>installationsbereiten Anwendung möglich, ohne daß deren Quellcode bekannt sein muß. Auch <BR/>kann durch das nachträgliche Erweitern um die Funktion diese Funktion immer in der <BR/>modernsten Art und Weise verwirklicht werden. </P><P ID="0013" ALIGN="LEFT">Die erweiterte Komponente kann die gleiche Anzahl von Dateien wie die (ursprüngliche) <BR/>Komponente (z.B. eine einzige Datei) umfassen. Es ist jedoch auch möglich, daß die erweiterte <BR/>Komponente mehr oder weniger Dateien als die (ursprüngliche) Komponente aufweist. In der <BR/>Regel wird die erweiterte Komponente jedoch mehr Softwarecode umfassen als die <BR/>ursprüngliche Komponente, um die gewünschte Funktion zu verwirklichen. </P><P ID="0014" ALIGN="LEFT">Bei der gewünschten Funktion kann es sich um die Ausprobieren/Kaufen-Fähigkeit oder auch <BR/>um ein Schützen der mittels des Installationsprogramms zu installierenden Anwendung gegen <BR/>unberechtigte Nutzung handeln. Im diesem Fall ist es vorteilhaft, daß die Art <BR/>Ausprobieren/Kaufen-Fähigkeit bzw. des Schutzes frei ausgewählt werden können und daß <BR/>dadurch insbesondere die installationsbereite Anwendung immer mit der modernsten <BR/>Ausprobieren/Kaufen-Fähigkeit bzw. dem modernsten Schutzmechanismus versehen werden <BR/>kann. </P><P ID="0015" ALIGN="LEFT">Ferner kann es sich bei der Funktion um eine Datenverschlüsselung handeln, die die Daten, <BR/>die die installierte Anwendung (z.B. im Zielsystem (Computer mit Prozessor, Arbeitsspeicher, <BR/>Ausgabe- und Eingabeeinheit und gegebenenfalls mit einem Betriebssystem)) ablegt, vor dem <BR/>Ablegen immer verschlüsselt, und die die Daten, die die installierte Anwendung wieder liest, <BR/>wiederum entschlüsselt. Dadurch wird vorteilhaft sichergestellt, daß die Daten nur für die <BR/>installierte Anwendung lesbar sind. </P><P ID="0016" ALIGN="LEFT">Es ist auch möglich, daß es sich bei der gewünschten Funktion um eine sogenannte Splash-Anzeige <BR/>handelt, die auf dem Bildschirm des Zielsystems unmittelbar nach Aufruf der <BR/>installierten Anwendung gezeigt wird und zumindest so lange auf dem Bildschirm stehen bleibt, <BR/>bis die installierte Anwendung geladen und ausführbar ist, wobei die Splash-Anzeige natürlich <BR/>auch länger dargestellt werden kann. Mit dieser Splash-Anzeige können Informationen <BR/>bezüglich der Anwendung, Werbung für z.B. Software-Produkte oder sonstige Daten <BR/>dargestellt werden. <DP N="5"/></P><P ID="0017" ALIGN="LEFT">Das Installationsprogramm kann in einer oder mehreren Dateien abgelegt sein, und die zu <BR/>installierende Komponente bzw. die zu installierenden Komponenten können komprimiert <BR/>und/oder zumindest teilweise verschlüsselt sein und in der bzw. den <BR/>Installationsprogrammdatei(en) und/oder in zusätzlichen Dateien abgelegt sein. Die <BR/>notwendigen Informationen für das Installationsprogramm zur Installation (z.B. zum Entpacken <BR/>des Programmarchivs) sind in der bzw. den Installationsprogrammdatei(en) und z.B. zum Teil <BR/>auch im Programmarchiv abgelegt. Der Hilfscode (der zumindest ausführbaren Softwarecode <BR/>und gegebenenfalls auch Daten enthalten kann) kann in der bzw. den <BR/>Installationsprogrammdatei(en) vollständig oder zum Teil abgelegt sein, kann aber auch in <BR/>einer oder mehreren separaten Dateien vorliegen. </P><P ID="0018" ALIGN="LEFT">Die Reihenfolge der Schnitte des erfindungsgemäßen Verfahrens ist frei wählbar, wobei es <BR/>auch möglich ist, Schritte zusammenzufassen und somit gleichzeitig auszuführen. </P><P ID="0019" ALIGN="LEFT">Bevorzugt wird bei dem erfindungsgemäßen Verfahren Hilfscode zum Softwarepaket <BR/>hinzugefügt, der bei seiner Ausführung bewirkt, daß bei Auftreten eines durch die Ausführung <BR/>des Installationsprogrammes bedingten Ereignisses die erweiterte Komponente statt der <BR/>Komponente installiert wird. Dadurch kann man einen ereignisbedingten Zeitpunkt auswählen, <BR/>zu dem die erweiterte Komponente mittels des Hilfscodes installiert wird, so daß sichergestellt <BR/>ist, daß nach Beendigung des Installationsvorganges des Installationsprogrammes und des <BR/>Hilfscodes die um die Funktion erweiterte Anwendung installiert ist. </P><P ID="0020" ALIGN="LEFT">In einer weiteren vorteilhaften Weiterbildung des erfindungsgemäßen Verfahrens wird <BR/>Hilfscode hinzugefügt, der bei seiner Ausführung bewirkt, daß die bereits installierte <BR/>Komponente durch die erweiterte Komponente ersetzt wird. Die installierte Komponente wird <BR/>dabei bevorzugt gelöscht, kann aber auch umbenannt werden, wobei dies natürlich nicht so <BR/>sicher wie das Löschen der installierten Komponente ist. Bei diesem Verfahren muß in den <BR/>Installationsvorgang des Installationsprogrammes nur geringfügig eingegriffen werden, es muß <BR/>lediglich sicher gestellt werden, daß nach der Installation der Komponente mittels des <BR/>Installationsprogrammes noch der Hilfscode ausgeführt wird (z.B. durch Verzweigung aus dem <BR/>Installationsprogramm in den Hilfscode), der dann das Ersetzen der installierten Komponente <BR/>durch die erweiterte Komponente bewirkt. </P><P ID="0021" ALIGN="LEFT">Bevorzugt wird die Ersetzung der installierten Komponente durch die erweiterte Komponente <BR/>durch den Hilfscode nach Abschluß der Installation der im Programmarchiv enthaltenen <BR/>Komponenten bewirkt, da dies technisch einfach zum Beispiel dadurch realisiert werden kann, <BR/>daß die bei Abschluß durch das Installationsprogramm aufzurufende Betriebssystemfunktion <DP N="6"/> <BR/>überwacht wird oder daß vor Aufruf dieser Funktion aus dem Installationsprogramm in den <BR/>Hilfscode verzweigt wird. </P><P ID="0022" ALIGN="LEFT">Eine vorteilhafte Ausgestaltung des erfindungsgemäßen Verfahrens besteht auch darin, daß <BR/>Hilfscode hinzugefügt wird, der bei seiner Ausführung bewirkt, daß die Installation der <BR/>Komponente verhindert und statt dessen die erweiterte Komponente installiert wird. Dieses <BR/>Verfahren ist in vorteilhafter Weise sehr sicher, da so in keinem Zeitpunkt die (unveränderte <BR/>bzw. ungeschützte) Komponente installiert ist und somit auch ein erzwungener Abbruch des <BR/>Installationsvorgangs nicht dazu führt, daß die Anwendung ohne die gewünschte Funktion, wie <BR/>z.B. Schutz gegen unberechtigte Nutzung, installiert ist. </P><P ID="0023" ALIGN="LEFT">Bevorzugt kann bei dem erfindungsgemäßen Verfahren Hilfscode hinzugefügt werden, der bei <BR/>seiner Ausführung bewirkt, daß der Installationsvorgang überwacht wird und bei Beginn der <BR/>Installation der Komponente durch das Installationsprogramm derart in diesen Vorgang <BR/>eingriffen wird, daß die Installation der Komponente verhindert wird. Diese Überwachung des <BR/>Installationsvorgangs kann durch einen Filter durchgeführt werden, der die Kommunikation <BR/>zwischen dem Installationsprogramm und dem Zielsystem, auf dem die Anwendung installiert <BR/>wird, überwacht. Der Filter kann bspw. auf Betriebssystemebene des Zielsystems eingerichtet <BR/>werden. Alternativ kann auch das Installationsprogramm so geändert werden, daß bei jedem <BR/>Betriebssystemaufruf zum Erzeugen einer Datei zum Hilfscode verzweigt wird, der dann <BR/>feststellen kann, ob die Komponente installiert (erzeugt) werden soll und dies dann verhindert. </P><P ID="0024" ALIGN="LEFT">Insbesondere kann beim erfindungsgemäßen Verfahren das Installationsprogramm derart <BR/>verändert werden, daß bei seiner Ausführung die Programmroutine zur Installation der <BR/>Komponente übersprungen wird. Die erweiterte (z.B. geschützte) Komponente kann direkt <BR/>nach dem Überspringen der Programmroutine oder auch zu einem anderen Zeitpunkt mittels <BR/>des Hilfscodes installiert werden. Auch dadurch wird somit sicher erreicht, daß nie die <BR/>ungeschützte Komponente bei der Installation installiert wird. </P><P ID="0025" ALIGN="LEFT">Bei dem erfindungsgemäßen Verfahren kann vor dem Schritt des Hinzufügens der erweiterten <BR/>Komponente diese in einem gesonderten Schritt erzeugt werden, so daß bspw. der Software-Distributor <BR/>allein die zu erweiternde Komponente der zu installierenden Anwendung auswählen <BR/>und erweitern kann. Bei diesem Schritt der Erzeugung kann die zu erweiternde Komponente <BR/>automatisch oder manuell ausgewählt werden. </P><P ID="0026" ALIGN="LEFT">Wenn das Programmarchiv mehrere zu installierende Komponenten enthält, kann bei einer <BR/>weiteren vorteilhaften Ausgestaltung des erfindungsgemäßen Verfahrens der Schritt der <BR/>Erzeugung der erweiterten Komponente folgende Schritte umfassen: <DP N="7"/></P><P ID="0027" ALIGN="LEFT">Installieren der zu erweiternden Anwendung, Auswählen einer der installierten Komponenten <BR/>als zu erweiternde Komponente und Erweitern der ausgewählten Komponente. </P><P ID="0028" ALIGN="LEFT">Die Erweiterung kann z.B. durch Hinzufügen eines Zusatzmoduls, das Code zur Verwirklichung <BR/>der gewünschten Funktion und gegebenenfalls notwendige Daten enthält, erfolgen, wobei <BR/>dabei z. B. noch der Startpunkt in der erweiterten Komponente auf das Zusatzmodul umgelegt <BR/>wird. Es kann auch jeder andere dem Fachmann bekannte Technik gewählt werden, die <BR/>sicherstellt, daß das Zusatzmodul bei Ausführung der Anwendung (bevorzugt der erweiterten <BR/>Komponente) seinerseits ausgeführt wird. Wenn die zu installierende Anwendung gegen <BR/>unberechtigte Nutzung geschützt werden soll, kann die ausgewählte Komponente mit einem <BR/>Schutzmodul ergänzt werden, das die Ausführung der veränderten Komponente nur bei <BR/>Vorliegen einer Laufberechtigung zuläßt. </P><P ID="0029" ALIGN="LEFT">Damit wird die Möglichkeit bereitgestellt, daß die Komponente, die geschützt werden soll, frei <BR/>ausgewählt werden kann, so daß der Software-Distributor die für ihn relevante Komponente <BR/>schützen kann. Das Auswählen der zu schützenden Komponente kann automatisch oder auch <BR/>manuell durchgeführt werden. So ist es bspw. möglich, daß die Komponente ausgewählt wird, <BR/>die zum Start der installierten Anwendung auszuführen ist. Damit wird dann auch <BR/>gewährleistet, daß die Schutzfunktion der installierten Anwendung nicht umgangen werden <BR/>kann. </P><P ID="0030" ALIGN="LEFT">Ferner wird durch die angegebene Erzeugung der geschützten Komponente auch ermöglicht, <BR/>daß die Art des Schutzes frei wählbar ist. Das Schutzmodul, mit dem die Komponente ergänzt <BR/>wird, überprüft bspw. ob ein vom Software-Distributor generiertes Zertifikat auf dem Zielsystem <BR/>oder ein bestimmtes Hardwareelement vorhanden ist. Nur wenn dies der Fall ist, liegt die <BR/>benötigte Laufberechtigung vor und kann die geschützte Komponente und damit die <BR/>Anwendung ausgeführt werden. </P><P ID="0031" ALIGN="LEFT">Des weiteren kann beim erfindungsgemäßen Verfahren das Installationsprogramm derart <BR/>geändert werden, daß eine im Installationsprogramm enthaltene Information, die den <BR/>Startpunkt des Installationsprogramms angibt, so verändert wird, daß sie nun einen im <BR/>Hilfscode liegenden Punkt als Startpunkt vorgibt. Damit wird in einfacher Art und Weise <BR/>gewährleistet, daß bei Aufruf des Installationsprogrammes immer sofort der Hilfscode gestartet <BR/>wird, so daß auch sicher gestellt wird, daß die erweiterte Anwendung installiert wird. </P><P ID="0032" ALIGN="LEFT">In einer vorteilhaften Weiterbildung des erfindungsgemäßen Verfahrens wird das <BR/>Programmarchiv verschlüsselt, so daß vorteilhaft verhindert werden kann, daß das <BR/>Programmarchiv, aus dem beim erfindungsgemäßen Verfahren die (unveränderte) <DP N="8"/> <BR/>Komponente nicht entfernt wird, mit einem anderen Installationsprogramm noch als nicht <BR/>erweiterte Anwendung installiert werden kann. Bei diesem Verschlüsseln muß vorteilhaft das <BR/>Dateiformat des Programmarchivs nicht bekannt sein und die Komponente muß auch nicht aus <BR/>dem Programmarchiv entfernt werden. </P><P ID="0033" ALIGN="LEFT">Insbesondere kann auch die erweiterte Komponente verschlüsselt werden, so daß eine nicht <BR/>gewünschte Änderung der erweiterten Komponente, mit der beispielsweise die Änderung der <BR/>Komponente rückgängig gemacht wird, effektiv verhindert werden kann. Wenn mehrere <BR/>erweiterte Komponenten zum Softwarepaket hinzugefügt werden, können alle diese <BR/>Komponenten oder auch nur zumindest eine dieser Komponenten verschlüsselt werden. </P><P ID="0034" ALIGN="LEFT">Bevorzugt wird dazu das Softwarepaket, insbesondere das Installationsprogramm, noch mit <BR/>einem Entschlüsselungsmodul (das Softwarecode und gegebenenfalls notwendige Daten <BR/>enthält) ergänzt, das beispielsweise nur bei Vorliegen einer Laufberechtigung, wie z.B. ein auf <BR/>dem Zielsystem vorhandenes Zertifikat, das vom Software-Distributor erzeugt ist, ein <BR/>bestimmtes Hardwareelement des Zielsystems, ein einzugebender Freischaltcode oder eine <BR/>eindeutige Kennung, das verschlüsselte Programmarchiv und gegebenenfalls die <BR/>verschlüsselte Komponente (n) entschlüsselt, so daß dann die erweiterte Anwendung installiert <BR/>werden kann. </P><P ID="0035" ALIGN="LEFT">Das erfindungsgemäße Computerprogrammprodukt umfaßt Softwarecode (und, falls nötig, <BR/>Daten), mit dem die Schritte des erfindungsgemäßen Verfahrens sowie vorteilhaft auch die der <BR/>bevorzugten Weiterbildungen des erfindungsgemäßen Verfahrens ausgeführt werden können, <BR/>wenn das Produkt auf einem Computer läuft. Ein solcher Computer umfaßt neben der <BR/>erforderlichen Hardware (wie z.B. Prozessor, Arbeitsspeicher, Ausgabeeinheit, Eingabeeinheit) <BR/>häufig auch noch ein Betriebssystem. Der Softwarecode (und gegebenenfalls die Daten) des <BR/>erfindungsgemäßen Computerprogrammprodukts ist an den Computer bzw. das Zielsystem so <BR/>angepaßt, daß bei Ausführung des Computerprogrammprodukts und somit des Softwarecodes <BR/>die Schritte des erfindungsgemäßen Verfahrens verwirklicht werden können. </P><P ID="0036" ALIGN="LEFT">In einer vorteilhaften Weiterbildung des erfindungsgemäßen Computerprogrammprodukts ist <BR/>dieses auf einem Datenträger gespeichert. Als Datenträger kann jedes Medium verwendet <BR/>werden, von dem das gespeicherte Computerprogrammprodukt wieder ausgelesen werden <BR/>kann, wie z.B. eine Diskette, eine CD, eine DVD, ein Magnetband oder auch eine Festplatte. </P><P ID="0037" ALIGN="LEFT">Die Erfindung wird nachfolgend beispielshalber anhand der Zeichnungen noch näher erläutert.<BR/>Es zeigen: <DP N="9"/><DL TSIZE="6" COMPACT="COMPACT"><DT>Fig. 1</DT><DD>schematisch den Aufbau eines Softwarepakets mit der zu erweiternden Anwendung; </DD><DT>Fig. 2</DT><DD>schematisch den Aufbau des Installationsprogrammes, das in dem in Fig.1 gezeigten <BR/>Softwarepaket enthalten ist; </DD><DT>Fig. 3</DT><DD>einen Ablaufplan des erfindungsgemäßen Verfahrens zum Erweitern der zu <BR/>installierenden Anwendung; </DD><DT>Fig. 4</DT><DD>schematisch den Aufbau des Softwarepakets mit der erweiterten Anwendung, und </DD><DT>Fig. 5</DT><DD>schematisch den Aufbau des Installationsprogrammes, das in dem in Fig. 4 gezeigten <BR/>Softwarepaket enthalten ist. </DD></DL></P><P ID="0038" ALIGN="LEFT">Wie in Fig. 1 gezeigt ist, umfaßt das Softwarepaket 1 ein ausführbares Installationsprogramm <BR/>2 und ein Programmarchiv 3, das die mittels des Installationsprogrammes 2 zu installierenden <BR/>Komponenten 4, 5, 6, 7 der Anwendung enthält, wobei die Komponenten 4, 5, 6, 7 in einem <BR/>dem Installationsprogramm 2 zugänglichen Dateiformat (z.B. in komprimierter Form) abgelegt <BR/>sind. Informationen zum Entpacken dieser komprimierten Komponenten 4 bis 7 und ihrer <BR/>Verwendung während der Installation der Anwendung sind im Installationsprogramm 2 <BR/>enthalten. </P><P ID="0039" ALIGN="LEFT">Der Aufbau und der exakte Inhalt des Installationsprogrammes, der in Fig. 2 gezeigt ist, hängt <BR/>zumindest vom Betriebssystem und vom Prozessor des Zielsystems (Betriebssystem und <BR/>Computer, der Prozessor, Arbeitsspeicher, Eingabeeinheit, Ausgabeeinheit und sonstige <BR/>Hardwareelemente ausweisen kann) ab, auf dem das Installationsprogramm ausgeführt <BR/>werden soll. </P><P ID="0040" ALIGN="LEFT">Der gezeigte Aufbau ist für ein Zielsystem mit einem Pentiumprozessor III (der Firma INTEL <BR/>Corporation) und einem Windows 98 Betriebssystem der Firma Microsoft Corporation (oder <BR/>auch Windows 95, Windows ME, Windows 2000 oder Windows NT von Microsoft) angegeben <BR/>und umfaßt eine Kennung 8, anhand der das Betriebssystem feststellen kann, um welchen <BR/>Dateityp es sich handelt (z.B. um eine ausführbare Datei: *.exe). Des weiteren sind Tabellen 9 <BR/>im Installationsprogramm 2 enthalten, in denen die Struktur des Installationsprogramms im <BR/>Detail beschrieben ist und die das Betriebssystem benötigt, um vor der Ausführung des <BR/>Installationsprogramm dieses in den Arbeitsspeicher des Zielsystems zu laden, damit der <BR/>Prozessor das Installationsprogramm dann ausführen kann. Unter anderem ist dazu in diesen <BR/>Tabellen der Startpunkt SP angegeben, an dem der Prozessor die Ausführung des <BR/>Programmes beginnen soll. Dieser Startpunkt SP zeigt auf ausführbaren Programm- bzw. <BR/>Softwarecode, der, wie in Fig. 3 gezeigt, oft in mehreren Abschnitten 10, 11 vorliegt (der <BR/>ausführbare Programmcode kann auch in nur einem oder in mehr als zwei Abschnitten <BR/>vorliegen). Schließlich sind noch Abschnitte 12 und 13 vorgesehen, in denen Daten, die vom <BR/>Installationsprogramm während seiner Laufzeit benutzt werden (wie z. B. die Informationen <DP N="10"/> <BR/>zum Entpacken der komprimierten Komponenten und ihre Verwendung), abgelegt sind. Die <BR/>Daten können auch in einem oder in mehreren Abschnitten abgelegt sein. Wenn keine Daten <BR/>benötigt werden, können diese Abschnitte auch entfallen. </P><P ID="0041" ALIGN="LEFT">Im folgenden wird im Detail beschrieben, wie die zu installierende Anwendung um die Funktion <BR/>des Schutzes gegen unberechtigte Nutzung erweitert werden kann. Zum Schützen der zu <BR/>installierenden Anwendung wird, wie in dem in Fig. 3 gezeigten Ablaufplan ersichtlich ist, zuerst <BR/>eine geschützte Version einer der zu installierenden Komponenten erzeugt (Schritt S1), wenn <BR/>diese geschützte Version noch nicht vorliegt. Dazu wird das in dem in Fig. 1 gezeigten <BR/>Softwarepaket 1 enthaltene Installationsprogramm 2 ausgeführt, so daß die Anwendung auf <BR/>einem Zielsystem installiert wird. Von den auf dem Zielsystem installierten Komponenten der <BR/>Anwendung wird dann eine erste Komponente 4 ausgewählt, die geschützt werden soll. Die <BR/>ausgewählte Komponente 4, die bevorzugt eine Komponente 4 ist, die zur Ausführung der <BR/>Anwendung unbedingt erforderlich ist, wie z. B. eine ausführbare Datei, wird dadurch <BR/>geschützt, daß sie mit einem Schutzmodul 14 versehen wird (das seinerseits ausführbaren <BR/>Code enthält). Ferner wird noch der in der Komponente 4 enthaltene Zeiger, der den <BR/>Startpunkt angibt, so verändert, daß er auf das Schutzmodul 14 zeigt, so daß bei Start der <BR/>geänderten Komponente 4 zuerst der Code des Schutzmoduls 14 ausgeführt wird. Dieser <BR/>Code des Schutzmoduls 14 überprüft, ob eine Laufberechtigung vorliegt, und gibt die <BR/>Komponente frei, wenn dies der Fall ist. Diese Überprüfung der Laufberechtigung kann bspw. <BR/>an das Vorhandensein eines Zertifikats, das nur vom Software-Distributor, -Hersteller oder <BR/>einer autorisierten Stelle erzeugt werden kann, geknüpft sein. </P><P ID="0042" ALIGN="LEFT">In einem zweiten Schritt S2 wird die geschützte erste Komponente 4' zum Softwarepaket 1 <BR/>außerhalb des Programmarchivs 3 hinzugefügt, so daß in diesem Schritt das Programmarchiv <BR/>3 nicht verändert wird. Insbesondere muß dazu die Struktur bzw. der Aufbau des <BR/>Programmarchivs auch nicht bekannt sein. </P><P ID="0043" ALIGN="LEFT">Danach wird Hilfscode 15 (der Softwarecode und, falls nötig, Daten umfaßt) wiederum <BR/>außerhalb des Programmarchivs 3 zum Softwarepaket 1 hinzugefügt (Schritt S3). Der <BR/>Hilfscode 15 wird dabei bevorzugt zum Installationsprogramm 2 hinzugefügt und sorgt, wie <BR/>nachfolgend noch beschrieben wird, bei der Installation der Anwendung dafür, daß statt der <BR/>ersten Komponente 4 die geschützte erste Komponente 4' installiert wird. </P><P ID="0044" ALIGN="LEFT">Schließlich wird das Installationsprogramm 2 auch noch so verändert (Schritt S4), daß <BR/>aufgrund der Ausführung des geänderten Installationsprogrammes 2' der Hilfscode 15 <BR/>gestartet wird. Der Aufbau des so geänderten Softwarepaket 1' ist in Fig. 4 schematisch <BR/>dargestellt. Die Änderungen des Installationsprogrammes (Schritt S4) läßt sich bspw. so <DP N="11"/> <BR/>durchführen, daß der in den Tabellen 9 angegebene Startpunkt SP nicht mehr auf <BR/>ausführbaren Code des Installationsprogrammes 2 zeigt, sondern auf den Hilfscode 15 (bzw. <BR/>ausführbaren Code davon), wie in Fig. 5 dargestellt ist (neuer Startpunkt SP'). </P><P ID="0045" ALIGN="LEFT">Bei den Schritten S1 bis S4 müssen weder die erste Komponente 4 noch die anderen <BR/>Komponenten 5, 6, 7 teilweise oder vollständig aus dem Programmarchiv entfernt werden, so <BR/>daß die Schritte S1 bis S4 ohne Kenntnis der genauen Struktur des Programmarchivs <BR/>durchführbar sind. Zur Durchführung der Schritte S1 bis S4 ist eine Änderung des <BR/>Programmarchivs 3 somit nicht notwendig. </P><P ID="0046" ALIGN="LEFT">Danach können optional (Schritt S5) noch das Programmarchiv 3 und die geschützte erste <BR/>Komponente 4'verschlüsselt werden, und zum Softwarepaket kann ein Entschlüsselungsmodul <BR/>(nicht gezeigt) hinzugefügt werden. Das Entschlüsselungsmodul wird bevorzugt zum <BR/>Installationsprogramm 2' hinzugefügt, das in diesem Fall nochmals in einer solchen Art <BR/>verändert wird, daß bei seiner Ausführung zuerst die Entschlüsselung des verschlüsselten <BR/>Programmarchivs und der verschlüsselten erweiterten ersten Komponente 4' erfolgt, wenn <BR/>eine benötigte Laufberechtigung vorliegt. Danach wird dann der Hilfscode 15 gestartet. Durch <BR/>die Verschlüsselung wird vorteilhaft erreicht, daß die zu installierende Anwendung, die im <BR/>Programmarchiv abgelegt ist und auch nach Durchführung des erfindungsgemäßen <BR/>Verfahrens noch die erste (nicht geschützte) Komponente enthält, nicht einfach als nicht <BR/>geschützte Anwendung (ohne Installation der geschützten ersten Komponente 4') z. B. mit <BR/>einem anderen Installationsprogramm installiert werden kann. Des weiteren wird auch eine <BR/>nicht gewünschte Änderung der geschützten ersten Komponente 4' aufgrund der <BR/>Verschlüsselung verhindert. </P><P ID="0047" ALIGN="LEFT">Optional kann noch ein weiterer Schritt S6 ausgeführt werden, mit dem spezielle Lizenzen (z.B. <BR/>Zertifikate, die das Vorliegen der Laufberechtigung anzeigen) und/oder ein Lizenzmanager, der <BR/>als Vermittlungsglied zwischen der geschützten Anwendung und der Lizenz fungiert, wiederum <BR/>außerhalb des Programmarchivs 3 zum Softwarepakt 1 hinzugefügt werden. In diesem Fall <BR/>weist der Hilfscode eine Funktion auf, mit der die Lizenzen und/oder der Lizenzmanager auf <BR/>dem Zielsystem installiert werden. </P><P ID="0048" ALIGN="LEFT">Der Hilfscode 15, der im Schritt S3 zum Softwarepaket hinzugefügt wird, wird aufgrund der <BR/>Änderungen des Installationsprogrammes in Schritt S4 bei Start des Installationsprogrammes <BR/>ausgeführt und sorgt dafür, daß nach Abschluß des Installationvorganges die geschützte <BR/>Anwendung (die Anwendung mit der geschützten ersten Komponente) auf dem Zielsystem <BR/>installiert ist. Dazu kann der Hilfscode 15 nach Installation der ersten (ungeschützten) <BR/>Komponente 4 durch das Installationsprogramm 2 die installierte erste Komponente 4 auf dem <DP N="12"/> <BR/>Zielsystem löschen und statt dessen die geschützte erste Komponente 4' auf dem Zielsystem <BR/>installieren. Dies läßt sich technisch dadurch verwirklichen, daß der Hilfscode 15 den <BR/>Betriebssystem-Aufruf des Installationsprogrammes 2', der die Beendigung des <BR/>Installationsprogrammes 2' anzeigt, überwacht und bei dessen Auftreten die Kontrolle <BR/>übernimmt und die Ersetzung der installierten ersten Komponente 4 durch die geschützte erste <BR/>Komponente 4' durchführt. Alternativ kann auch im Installationsprogramm 2' eine Verzweigung <BR/>vor diesem Betriebssystemaufruf zu dem Hilfscode 15 im Schritt S4 eingefügt werden. </P><P ID="0049" ALIGN="LEFT">Des weiteren kann der Hilfscode 15 auch so ausgelegt sein, daß die Installation der ersten <BR/>Komponente 4 durch das Installationsprogramm 2 verhindert und statt dessen die geschützte <BR/>erste Komponente 4' installiert wird. Dies läßt sich technisch z. B. dadurch realisieren, daß der <BR/>Hilfscode 15 einen Filter installiert, der die Kommunikation zwischen dem <BR/>Installationsprogramm 2' und dem Zielsystem überwacht und so feststellt, wann die Installation <BR/>der ersten Komponente 4 beginnt. Zu diesem Zeitpunkt wird dann die Kontrolle an den <BR/>Hilfscode 15 übergeben, der statt dessen die geschützte erste Komponente 4' installiert und <BR/>das Installationsprogramm 2' entweder nach der Installationsroutine für die erste Komponente <BR/>4 fortsetzt oder dem Installationsprogramm 2' solche Rückmeldungen gibt, daß für das <BR/>Installationsprogramm 2' die Installation der ersten Komponente 4 erfolgreich durchgeführt <BR/>wurde, so daß das Installationsprogramm 2' den Installationsvorgang normal fortsetzt. </P><P ID="0050" ALIGN="LEFT">Durch das erfindungsgemäße Verfahren zum Erweitern der zu installierenden Anwendung um <BR/>eine gewünschte Funktion (wie z.B. Schutz gegen unberechtigte Nutzung) wird somit sicher <BR/>gestellt, daß nach Abschluß des Installationsvorganges nur die erweiterte Anwendung auf dem <BR/>Zielsystem installiert ist. </P><P ID="0051" ALIGN="LEFT">Das in Fig. 4 gezeigte geänderte Softwarepaket 1' kann in einer oder auch in verschiedenen <BR/>Dateien abgelegt sein. Bei dem geänderten Softwarepaket 1' können, falls nötig, noch Schritte <BR/>durchgeführt werden, mit denen Änderungen bewirkt werden, die zum elektronischen Vertrieb <BR/>des geänderten Softwarepakets notwendig sind. </P></SDODE>