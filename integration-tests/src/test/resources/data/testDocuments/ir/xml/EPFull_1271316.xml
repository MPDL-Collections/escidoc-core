<?xml version="1.0" encoding="UTF-8"?><SDODE LA="D"><DP N="1"/><P ID="0001" ALIGN="LEFT"> xmlfulltext 简体中文网页 Während der Sicherung von in einzelnen Dateien abgelegten Daten <BR/>einer Datenbank ist aus Konsistenzgründen eine Veränderung <BR/>der Daten in den einzelnen Dateien nicht zulässig. Aus <BR/>diesem Grund werden die Dateien ab einem bestimmten Zeitpunkt <BR/>während eines Sicherungslaufes für verändernde Zugriffe gesperrt. <BR/>Nach erfolgtem Kopieren der Dateien wird die Sperre <BR/>wieder aufgehoben. </P><P ID="0002" ALIGN="LEFT">Mit zunehmender Größe der Datenbank steigt der Zeitbedarf für <BR/>einen solchen Sicherungslauf, was dazu führt, daß während eines <BR/>Sicherungslaufes das auf die einzelnen Dateien der Datenbank <BR/>zugreifende System in seiner Leistung und Funktionsfähigkeit <BR/>beeinträchtigt wird. </P><P ID="0003" ALIGN="LEFT">Um dieses Problem zu vermeiden, könnte ein Verfahren eingesetzt <BR/>werden, das die Veränderungen zwar zuläßt, diese jedoch <BR/>während des Sicherungslaufes nicht in die Dateien der zu sichernden <BR/>Datenbank einarbeitet, sondern eine separate Aufzeichnungsdatei <BR/>anlegt, die nach Beendigung des Sicherungslaufes <BR/>in die Dateien der Datenbank eingearbeitet werden würde. <BR/>Während des Verarbeitens dieser ersten Aufzeichnungsdatei <BR/>wäre wiederum von Veränderungen an den Dateien der Datenbank <BR/>auszugehen. Diese Veränderungen dürften aus Konsistenzgründen <BR/>erst nach Einarbeitung aller Veränderungen aus der ersten <BR/>Aufzeichnungsdatei vorgenommen werden und müßten daher in einer <BR/>zweiten Aufzeichnungsdatei erfaßt werden. Das Verfahren <BR/>würde dann instabil, wenn die zweite Aufzeichnungsdatei <BR/>schneller wächst als die erste Aufzeichnungsdatei abgearbeitet <BR/>werden kann. </P><P ID="0004" ALIGN="LEFT">Ein Problem im Zusammenhang mit der Datensicherung besteht <BR/>darin, die Dauer der während des Kopierens der Dateien für <BR/>die gesamte Datenbank notwendige Sperre so zu verkürzen, daß <DP N="2"/> <BR/>Instabilitäten nicht auftreten, ohne dabei den Umfang des Sicherungslaufes <BR/>einzuschränken. </P><P ID="0005" ALIGN="LEFT">Die der vorliegenden Erfindung zugrundeliegende Aufgabe besteht <BR/>darin, ein Verfahren zur Datensicherung anzugeben, welches <BR/>eine möglichst kurze Veränderungssperre der zu sichernden <BR/>Daten erfordert. </P><P ID="0006" ALIGN="LEFT">Diese Aufgabe wird durch die Merkmale des Patentanspruchs 1 <BR/>gelöst. </P><P ID="0007" ALIGN="LEFT">Ein wesentlicher Vorteil des erfindungsgemäßen Verfahrens besteht <BR/>darin, daß Leistung und Funktionsfähigkeit des auf die <BR/>Datenbank zugreifenden Systems während des ersten Schrittes <BR/>nicht beeinträchtigt werden. Der zusätzliche Aufwand für das <BR/>Erstellen der Aufzeichnungsdatei ist vernachlässigbar. Nur <BR/>während des zweiten Verfahrensschrittes ist eine Sperre der <BR/>zu sichernden Daten erforderlich. Es ist davon auszugehen, <BR/>daß die Anzahl der im zweiten Schritt zu übertragenden Dateien <BR/>sehr viel kleiner ist als die Anzahl der im ersten Schritt <BR/>zu übertragenden Dateien. Daher wird durch das erfindungsgemäße <BR/>Verfahren eine wesentlich verkürzte Veränderungssperre <BR/>erreicht. </P><P ID="0008" ALIGN="LEFT">Gemäß einer vorteilhaften Ausgestaltung kann ein Parameter, <BR/>beispielsweise die Anzahl der während des ersten Schrittes <BR/>veränderten Dateien oder Summe der Größen aller während des <BR/>ersten Schrittes veränderten Dateien, herangezogen werden, um <BR/>zu verhindern, daß aufgrund eines zu großen zu übertragenden <BR/>Datenvolumens während des zweiten Schrittes die Veränderungssperre <BR/>zu lange aufrechterhalten werden muß. </P><P ID="0009" ALIGN="LEFT">Nach einer weiteren vorteilhaften Ausgestaltung des erfindungsgemäßen <BR/>Verfahrens kann eine maximale Zeitdauer für den <BR/>zweiten Schritt vorgesehen werden. Bei Überschreitung dieser <BR/>Zeitdauer, z.B. aufgrund hoher Systemlast oder höherpriorer <BR/>Prozesse, wird die Datensicherung abgebrochen, um zu verhindern, <DP N="3"/> <BR/>daß die Veränderungssperre zu lange aufrechterhalten <BR/>werden muß. </P><P ID="0010" ALIGN="LEFT">Weitere vorteilhafte Ausgestaltungen der Erfindung sind den <BR/>Unteransprüchen zu entnehmen. </P><P ID="0011" ALIGN="LEFT">Im folgenden wird das erfindungsgemäße Verfahren anhand einer <BR/>Zeichnung näher erläutert. </P><P ID="0012" ALIGN="LEFT">Die Figur zeigt den Ablauf der CFA (<U TYPE="BAR" STYLE="SINGLE">C</U>opy <U TYPE="BAR" STYLE="SINGLE">F</U>ile <U TYPE="BAR" STYLE="SINGLE">A</U>gain, erneutes <BR/>Kopieren der Dateien) Methode zur Sicherung von Dateien einer <BR/>Datenbank DB, deren einzelne Dateien auf einem Data Base File <BR/>Server DBFS abgelegt sind. Die Datensicherung wird durch eine <BR/>Management-Funktion MF angestoßen. </P><P ID="0013" ALIGN="LEFT">Die Datensicherung läuft in folgenden Schritten ab: <SL COMPACT="COMPACT"><LI>(1) Durch Zeitsteuerung oder Benutzereingabe wird in MF die <BR/>Durchführung einer Datensicherung veranlaßt. </LI><LI>(2) MF signalisiert an DBFS, daß DBFS in den Aufzeichnungsmodus <BR/>treten soll. </LI><LI>(3) DBFS beendet alle anstehenden Transaktionen und schließt <BR/>alle offenen Dateien. Dieser Vorgang wird Die-Out-Phase <BR/>genannt. </LI><LI>(4) DBFS öffnet die Aufzeichnungsdatei, in der alle von nun <BR/>an veränderten Dateien vermerkt werden. </LI><LI>(5) DBFS signalisiert an MF, daß mit der Übertragung der zu <BR/>sichernden Daten begonnen werden kann. </LI><LI>(6) MF signalisiert nach Abschluß der Übertragung aller zu <BR/>sichernden Daten an DBFS, daß der Aufzeichnungsmodus zu <BR/>beenden ist. </LI><LI>(7) DBFS durchläuft eine zweite Die-Out-Phase und schließt <BR/>die Aufzeichnungsdatei. </LI><LI>(8) DBFS prüft, ob die Durchführung von CFA, d.h. das erneute <BR/>Kopieren der - veränderten - Dateien, möglich ist. <BR/>Als Kriterien stehen die Anzahl oder das Gesamtdatenvolumen <BR/>der in der Aufzeichnungsdatei vermerkten Dateien <DP N="4"/> <BR/>zur Verfügung. Falls die Auswertung der Aufzeichnungsdatei <BR/>einen Wert kleiner als das gewählte Kriterium liefert, <BR/>wird der Vorgang mit CFA fortgesetzt, andernfalls <BR/>an dieser Stelle abgebrochen, die bis dahin erfolgte Sicherung <BR/>wird verworfen und die Aufzeichnungsdatei gelöscht. </LI><LI>(9) DBFS aktiviert die Datenveränderungssperre. </LI><LI>(10) DBFS signalisiert an MF mit dem CFA, d.h. dem erneuten <BR/>Kopieren der Dateien anhand der Aufzeichnungsdatei, zu <BR/>beginnen. Dazu liefert DBFS die Aufzeichnungsdatei an <BR/>MF, so daß MF alle in dieser Liste enthaltenen Dateien <BR/>erneut übertragen kann. </LI><LI>(11) MF überträgt die Dateien. Folgender Mechanismus kann optional <BR/>eingesetzt werden: Falls durch DBFS festgestellt <BR/>wird, daß die Dateiübertragung und damit die Veränderungssperre <BR/>z.B. aufgrund hoher Systemlast zu länger als <BR/>eine vorgegebene Zeit dauert, wird der Vorgang an dieser <BR/>Stelle abgebrochen, die bis dahin erfolgte Sicherung <BR/>wird verworfen und die Aufzeichnungsdatei gelöscht. </LI><LI>(12) MF signalisiert nach Abschluß der Übertragung aller erneut <BR/>zu übertragenden Dateien an DBFS, daß die Veränderungssperre <BR/>aufzuheben ist. </LI><LI>(13) DBFS geht in den normalen Arbeitsmodus über und löscht <BR/>die Aufzeichnungsdatei für die nächste Datensicherung. </LI></SL></P></SDODE>